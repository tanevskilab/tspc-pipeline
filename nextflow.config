process {
    executor = 'slurm'

    withLabel: 'medium_job' { 
        cpus    = {1* task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 20.min * task.attempt}
    }

    withLabel: 'large_job' { 
        cpus    = {1* task.attempt }
        memory = { 128.GB * task.attempt }
        time = { 40.min * task.attempt}
    }

    withLabel: 'process_single' {
        cpus   = {1* task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 40.min * task.attempt }
    }

    withLabel: 'gpu_job' {
        clusterOptions = '--partition=gpu-single --ntasks-per-node=2 --gres=gpu:1,gpumem_per_gpu:100GB --mem=230gb'
    }
}

profiles {
    apptainer {
      apptainer.enabled       = false
      apptainer.autoMounts    = false
      conda.enabled           = false
      docker.enabled          = false
      singularity.enabled     = true
      singularity.autoMounts  = true
      singularity.runOptions  = '--nv'
      podman.enabled          = false
      shifter.enabled         = false
      charliecloud.enabled    = false
    }
}

singularity.registry  = 'quay.io'
report.overwrite = true